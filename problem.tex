
\section{Постановка задачи}
	
	\newtheorem{ut}{Утверждение}
	\newtheorem*{zam}{Замечание}
	Получим для такой системы рекуррентные соотношения, связывающую энергию системы из $n+1$ спина с энергией $n$ спинов.  Обозначим $n$ частичный гамильтониан через $H^n$
	\begin{multline}
		H^{n+1} = - J\sum_{i=1} ^{n}  S_i S_{i+1} + \sum_{i=1}^{n+1} h_i S_i  = 
		-J \sum_{i=1}^{n-1} S_{i} S_{i+1} - \sum_{i=1}^{n} h_i S_i - J S_n S_{n+1} - h_{n+1} S_{n+1} = \\=
		H^n - J S_n S_{n+1} - h_{n+1} S_{n+1} 
	\end{multline}
	Для минимума энергии:
	\begin{equation}
	\label{min_energy}
	E_{min}^{n+1} = \min_{\{S\}\setminus \{S_{n+1}\}} E^{n+1} = \min_{S_n}(E_{min}^{n} - J S_n S_{n+1} - h_{n+1} S_{n+1})
	\end{equation}
	Отображение $E_{min}^n : \{-1, 1\}  \to \mathbb{R}$ можно записать через два параметра:
	
	\begin{equation}
	E^n_{min} = \varepsilon_n - H_n S_n
	\end{equation}
	Выражение (\ref{min_energy}) тогда примет вид:
	\begin{equation}
	E_{min}^{n+1} = \varepsilon_n - \frac {\left|h_n +H_n+J\right|} 2 (1+S_{n+1})  - \frac{\left|h_n+H_n-J\right|} 2 (1 - S_{n+1})
	\end{equation}
	а рекуррентные выражения для параметров запишутся следующим образом: 
	\begin{equation}
	\varepsilon_{n+1} = \varepsilon_n - \frac{1} 2 \left(|h_n + H_n + J_n| + |h_n+H_n - J_n| \right)
	\end{equation}
	\begin{equation}
	\label{rec}
	H_{n+1} = \frac{1}{2} \left(|h_n + H_n + J_n| - |h_n + H_n - J_n| \right)
	\end{equation}

	Рассмотрим отдельно равенство (\ref{rec}). 
	Попробуем найти для этого рекуррентного соотношения инвариантное множество. Допустим, что $H_0=0$.
	 Далее, строя дерево возможных значений в зависимости от значений поля, можно заметить, что $|H_{n}| \leq J$. Для крайних точек выпадение поля $h (-h)$ соответствует переходу в себя.
	Выписывая теперь дерево возможных значений для точек $\pm J$, получим два непересекающихся множества:
	 \begin{equation}
		H_{inv} = \left\{ -J, -J + h, \dots, -J + kh \right\} \cup \left\{ J, J - h, \dots, J - kh \right\},
	\end{equation}
	где $k = \floor*{ \frac{2J}{h}}$, $h$ - минимальный дискретный шаг по полю.

	Несложно также убедиться, что, начиная с любого $H_0$, можно попасть в это инвариантное множество, поэтому в дальнейшем выбор начального значения нас интересовать не будет.
	Для определённости рассмотрим конкретное распределение, а потом обобщим результаты на более широкий класс распределений:
\begin{equation}
P(h_n) =
\begin{cases}
p_1 &\mbox{для } h_n= -h \\
p_2 &\mbox{для } h_n= 0 \\
p_3 &\mbox{для } h_n= h\\
\end{cases}
\end{equation}
\begin{equation}
p_1+p_2+p_3 = 1
\end{equation}
Задача поиска энергии основного состояния сведётся к поиску предельного распределения для следующего марковского процесса:
\begin{align}
\begin{split}
a_i(t+1) &= p_3 a_{i-1} + p_2 a_i + p_1 a_{i+1}\\
b_i(t+1)&= p_3 b_{i+1} + p_2 b_i + p_1 b_{i-1}\\
a_0(t+1)&= (p_1 + p_2) a_0 + p_1 a_1 + p_1 b_k\\
b_0(t+1) &= (p_2 + p_3) b_0 + p_3 b_1 + p_3 a_k \\
a_k(t+1) &= p_2 a_k + p_3 a_{k-1}\\
b_k(t+1) &= p_2 b_k + p_1 b_{k-1},\\
\end{split}
\end{align}
где $a_i$ - вероятность оказаться в состоянии $-J+ih$, а $b_i$ - в состоянии $J-hi$ соответственно.

Графически это можно представить следующим образом (в некоторых точках опущена стрелка соответствующая $p_2$ переходу, чтобы избежать загромождения рисунка):

\begin{figure}[h!]
	\centering
	\begin{tikzpicture}[->, >=stealth', auto, semithick, node distance=3.2cm,scale=1]
\tikzstyle{every state}=[fill=white,draw=black,thick,text=black,scale=1, minimum size=17mm]

\node[state]    (A)                     {$-J$};
\node[state]    (B)[right of=A]   {$-J+h$};
\node[draw=none]    (C)[right of=B]   {$\hspace{0.1in}\dots\hspace{0.1in}$};
\node[state]    (D)[right of=C]   {$-J+kh$};
\node[state]    (E)[below of=A,yshift=-25pt]{$J-kh$};
\node[draw=none]    (F)[right of=E] {$\hspace{0.1in}\dots\hspace{0.1in}$};
\node[state]    (G)[right of=F] {$J-h$};
\node[state]    (H)[below of=D,yshift=-25pt]{$J$};

\path
(A) edge[loop left]     node{$p_1+p_2$}         (A)
edge[bend left]  node{$p_3$}     (B)
(B) edge[bend left]               node{$p_3$}           (C)
edge[bend left]                node{$p_1$}           (A)
(C) edge[bend left]               node{$p_3$}           (D)
edge[bend left]                node{$p_1$}           (B)
(D) edge               node{$p_3$}           (H)
edge[bend left]                node{$p_1$}           (C)

(H)  edge[bend left]                node{$p_1$}           (G)
edge[loop right]     node{$p_2+p_3$}         	(H)
(G) edge[bend left]                node{$p_1$}           (F)
edge[bend left] node{$p_3$} (H)
(F) edge[bend left] 		        node{$p_1$}         (E)
edge[bend left]node{$p_3$}         (G)

(E) edge 		        node{$p_1$}         (A)
edge[bend left]node{$p_3$}         (F);

\end{tikzpicture}
\caption{Граф марковского процесса на инвариантном множестве}
\end{figure}
		Вышеописанная марковская цепь обладает предельным распределением, соответствующему собственному вектору матрицы перехода при единичном собственном значении. Это свойство значительно упростит нашу задачу.